<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>CLUSTERfoo! - Rails Cheatsheet</title>
    <link rel="stylesheet" href="/style/style.css">
    <link href="atom.xml" type="application/atom+xml" rel="alternate" title="Atom Feed">
    <!-- you don't need to keep this, but it's cool for stats! -->
    <meta name="generator" content="nanoc 3.6.3"> 
    <!-- MathJax for displaying math -->
    <script type="text/javascript"
      src="https://c328740.ssl.cf1.rackcdn.com/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
    </script>
    <!-- START Google Analytics -->
    <script type="text/javascript">
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-33332254-1']);
      _gaq.push(['_trackPageview']);
      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
    <!-- END Google Analytics -->
  </head>
  <body>
    <div id="everything">
      <div id="main">
        <header>
          <hgroup>
            <h1>CLUSTERfoo!</h1>
            <h2>Possibly the best blog on the topic of me.</h2>
          </hgroup>
        </header>
        <div id="content">
          
            <article>
  <h2>Rails Cheatsheet</h2>
  <!-- _. -->

<p><strong>Updated:</strong> Instad of <code>.rvmrc</code>, I now use <code>.ruby-version</code> and <code>.ruby-gemset</code>.</p>

<hr>

<p>A little cheatsheet of Rails stuff I don’t want to forget. Many of these
tips come from 
<a href="http://ruby.railstutorial.org/" target="_blank">Michael Hartl’s Rails tutorial</a>.</p>

<!-- _. -->

<h3 id="setting-up-environment">Setting Up Environment</h3>

<h4 id="install-rvm-ruby-bundler">Install RVM, Ruby, Bundler</h4>

<p>Install RVM through instructions on <a href="http://rvm.io" target="_blank">rvm.io</a>.
<!-- _. -->
RVM now also eliminates the need to use <code>bundle exec</code> when used with bundler. </p>

<p>Install latest ruby. The following OpenSSL option is needed on Ubuntu:</p>

<pre><code>$ rvm install 1.9.3-head --with-openssl-dir=$HOME/.rvm/
</code></pre>

<blockquote>
  <p><em>Aside:</em></p>

  <p>If you ever get the following warning:</p>

  <p><code>make: /usr/bin/gcc-4.2: No such file or directory</code></p>

  <p>You will also need to run</p>

  <p><code>$ rvm reinstall 1.9.3-head --with-gcc=clang</code></p>
</blockquote>

<p>Create project gemset and be in it before installing Rails:</p>

<pre><code>$ rvm use 1.9.3-head@projectname --create
</code></pre>

<p>Project-specific gemsets prevent big headaches. Don’t forget to set a 
project <code>rvmrc</code> file after Rail app is generated (see below).</p>

<h4 id="install-rails">Install Rails</h4>

<pre><code>$ gem install rails
</code></pre>

<p>And if on Linux, also run:</p>

<pre><code>$ sudo apt-get install libxslt-dev libxml2-dev libsqlite3-dev
</code></pre>

<p>Install node.js so that rails server can run properly in your development
environment.</p>

<h3 id="initialize-rails-app">Initialize Rails App</h3>

<h4 id="set-up-rails-app-directory">Set up Rails App Directory</h4>

<p>Skip TestUnit if you’re using rspec:</p>

<pre><code>$ rails new project_name --skip-test-unit
</code></pre>

<p>Now create two files: <code>.ruby-version</code> and <code>.ruby-gemset</code>. These files will 
ensure that rvm, or whatever ruby envelope you use, know to switch to the 
correct Ruby version (and gemset, in rvm). For example, if you’re using Ruby
2.0.0 and a gemset called <code>my-project</code>, create a <code>.ruby-version</code> file with the
following content:</p>

<pre><code>2.0.0
</code></pre>

<p>And a <code>.ruby-gemset</code> file with:</p>

<pre><code>my-project
</code></pre>

<p>Now <code>cd</code> in and out of the directory and make sure that rvm is switching to the 
correct gemset with:</p>

<pre><code>$ rvm gemset list
</code></pre>

<h4 id="set-up-rspec">Set up Rspec</h4>

<p>Add rspec, guard and spork to development / test environment in Gemfile:</p>

<pre><code>group :development, :test do
  gem 'rspec-rails', '~&gt; 2'

  # If using guard and spork:
  gem 'guard-rspec', '~&gt; 2'
  gem 'guard-spork', '~&gt; 1'
  gem 'spork', '~&gt; 0.9'
end
</code></pre>

<p>Make Rails use rspec instead of TestUnit:</p>

<pre><code>$ rails g rspec:install
</code></pre>

<h4 id="speeding-up-tests-with-spork-and-guard">Speeding up Tests with Spork and Guard</h4>

<p>Follow 
<a href="http://ruby.railstutorial.org/chapters/static-pages#sec-guard" target="_blank">these instructions</a>.
<!-- _. --></p>

<h4 id="heroku--deployment">Heroku / Deployment</h4>

<p>Add PostgreSQL gem and production-environment-specific gems. In gem file:</p>

<pre><code>group :production do
  gem 'pg'
end
</code></pre>

<p>To run bundler without production gems</p>

<pre><code>$ bundle install --without production
</code></pre>

<p>Bundler remembers this setting, no need to use it again.</p>

<p>Initialize Heroku:</p>

<pre><code>$ heroku login
$ heroku create
</code></pre>

<p>Push to Heroku and rename:</p>

<pre><code>$ git push heroku
$ heroku rename project_name
</code></pre>

<h3 id="maintenance">Maintenance</h3>

<h4 id="after-migrations">After Migrations</h4>

<p>After running</p>

<pre><code>$ rake db:migrate
</code></pre>

<p>The following come in handy:</p>

<p>Stop the Rails server. This is obvious, but forgetting to restart the server
after a migration is a sure way to waste time wondering why half your tests are
suddenly failing.</p>

<p>Annotate models and migrations (requires the <code>annotate</code> gem):</p>

<pre><code>$ annotate
</code></pre>

<p>Tell the test database about the migration too:</p>

<pre><code>$ rake db:test:prepare
</code></pre>

<p>Restart the Rails server.</p>

<p>Sometimes you want to reset your test database:</p>

<pre><code>$ rake db:reset
$ rake db:test:prepare
</code></pre>

<h4 id="run-console-in-sandbox-mode">Run Console in Sandbox Mode!</h4>

<p>Don’t break things:</p>

<pre><code>$ rails console --sandbox
</code></pre>

</article>
<!-- START disqus copypasta: -->
<div id="disqus_thread"></div>
  <script type="text/javascript">
      /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
      var disqus_shortname = 'clusterfoo'; // required: replace example with your forum shortname

      /* * * DON'T EDIT BELOW THIS LINE * * */
      (function() {
          var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
          dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
          (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
      })();
  </script>
  <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
  <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
<!-- END disqus copypasta -->

          
        </div>
      </div>
      <aside id="sidebar">
        <div id="sidebar-content">
  <!-- menu -->
  <h3>Browse:</h3>
  <nav id="main-menu">
    <ul>
      <li><a href="/" title="Homepage">Home</a>
      <li><a href="/all-articles">All Articles</a>
      <li><a href="/links">Check it Out!</a>
      <li><a href="/talks">Watch This!</a>
      <li><a href="http://github.com/clusterfoo" title="My code on github" 
        target="_blank">My Github</a>
      <li><a href="/me/about" title="About Me">About Me</a>
    </ul>
  </nav>

  <h3>My "Blurblog":</h3>
  <p>News articles I'm sharing and talking about on NewsBlur:
  <a href="http://clusterfoo.newsblur.com">Click it, ya dingus.</a>

  <h3>Subscribe in a Reader:</h3>

  <p><a href="http://feeds.feedburner.com/Clusterfoo" title="Subscribe to my feed" 
    rel="alternate" type="application/rss+xml"><img 
      src="//feedburner.google.com/fb/images/pub/feed-icon32x32.png" alt="" 
      style="border:0"/></a>
      <a href="http://feeds.feedburner.com/Clusterfoo" 
        title="Subscribe to my feed" rel="alternate" 
        type="application/rss+xml">Click me!</a>

</div>


      </aside>
      <footer>
        &copy; 2013 Noam Gagliardi
      </footer>
    </div>
  </body>
</html>
